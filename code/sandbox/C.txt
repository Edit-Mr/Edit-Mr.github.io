function doGet(e) {
  return HtmlService.createHtmlOutputFromFile('beta.html');
}

function uploadFiles(form) {  
  try {
    var folder = DriveApp.getFolderById('1w7oA3Qwdf8DljAkNQYAMTERmD0uFHmbu');
    var blob = form.myFile;
    var file = folder.createFile(blob);    
    file.setDescription("上傳者： " + form.Name + " 電話： "+ form.Phone + " 信箱： " + form.Email);
    var fileName = 123;
    file.setName(fileName);
    var fileUrl = file.getUrl();
    var SpreadSheet = SpreadsheetApp.openById("1yJ2ZqognWOyMHyF1cGTSIHAthYDkRtCNJeB7CuEj8wE");
    var Sheet = SpreadSheet.getSheets()[0];
    var lastRow = Sheet.getLastRow();
    sheet.getRange(lastRow+1, 1, 1, 6).setValues([[new Date().toLocaleString(),user,fileName,fileUrl]]);
    return "檔案上傳成功！"
  } catch (error) {    
    return error.toString();
  }
}
