<!DOCTYPE html>
<html lang="en" >
   <head>
      <!-- Global site tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-9R5PZG2VQG"></script>
      <script>
         window.dataLayer = window.dataLayer || [];
         function gtag(){dataLayer.push(arguments);}
         gtag('js', new Date());
         
         gtag('config', 'G-9R5PZG2VQG');
      </script>
      <meta charset="UTF-8">
      <title>303電腦課留言系統</title>
      <meta name="description" content="303電腦課留言系統">
      <meta name="keywords" content="EM's Base, Edit Mr.">
      <meta name="author" content="Elvis Mao">
      <link href="chat.png" rel="icon" type="image/x-icon">
      <link rel="stylesheet" type="text/css" href="../../css/normalize.css" media="screen">
      <link rel="stylesheet" type="text/css" href="../../css/cayman.css" media="screen">
      <link rel="stylesheet" type="text/css" href="../../css/Animate.css" media="screen">
      <link rel="stylesheet" href="style.css">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
   </head>
   <body>
      <!-- Google Tag Manager (noscript) -->
      <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NHBZ3RD"
         height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
      <!-- End Google Tag Manager (noscript) -->
      <div class="header">
      <h1 class="project-name">303電腦課留言系統</h1>
      <h2 class="project-tagline">
         <a href="../../" target="_blank">毛哥EM</a>製作(尚未完成)<br />
         發送後請稍等數秒。每秒更新訊息
      </h2>
      <form action="https://script.google.com/macros/s/AKfycbyBMmqH6mir6KV1Sklt3jxr4sPVsubVjYjToGZvEfdeuw9KaZgZPtpFCc3I2vCzPLFP/exec" method="post">
         <input type="text"placeholder="顯示名稱" class="text" id="name"  autofocus/>
         <input type="text" name="msg" placeholder="訊息" id="msg" class="text" required />
         <button type="button" id="sendOrder" class="btn">發送</button>
      </form>
<<<<<<< HEAD
      <h1>實用連結</h1>
      <button type="button" class="btn" onclick="window.open('https://shellshock.io/')">Shell Shockers</button>
      <button type="button" class="btn" onclick="window.open('https://smashkarts.io/')">Smash Karts</button>
      <button type="button" class="btn" onclick="window.open('https://www.roblox.com/')">Roblox</button>
      <center>
    <div class="dialogue-wrap NavFrame" style="position: relative; width: 23.4em; margin: 2em 0em; padding: 0; border: 0.7px solid rgba(0,0,0,0.3); background-color: rgba(255,255,255,1); box-shadow: 0 14px 18px rgba(0,0,0,0.52); border-radius: 0.3em; overflow: hidden;">
        <div class="dialogue-head" style="position: relative; height: 1.4em; border-bottom:0.7px solid rgba(187,187,187,1); text-align:center; background: linear-gradient(to top, rgba(0,0,0,0.09), rgba(0,0,0,0.06)); color: rgba(0,0,0,0.8);"><span style="position: relative; font-size: 0.8em; line-height: 1.4em; cursor: default;">{{{1}}}</span>
            <div class="dialogue-head-window-options" style="position: absolute; top: 0.4em; left: 0.6em; height: 0.6em; width: 0.6em; border-radius: 100%; float: left; background: rgba(255,88,77,1); border: 0.5px solid rgba(235,78,67,1);"></div>
            <div class="dialogue-head-window-options" style="position: absolute; top: 0.4em; left: 1.67em; height: 0.6em; width: 0.6em; border-radius: 100%; float: left; background: rgba(255,197,40,1); border: 0.5px solid rgba(235,177,34,1);"></div>
            <div class="dialogue-head-window-options" style="position: absolute; top: 0.4em; left: 2.74em; height: 0.6em; width: 0.6em; border-radius: 100%; float: left; background: rgba(82,210,75,1); border: 0.5px solid rgba(70,200,65,1);"></div>
        </div>
        <div class="NavHead" style="position: absolute; top:0; left:0; height:1.4em; width:100%; border-bottom:0.7px solid #000; opacity:0;"></div>
        <div class="NavContent">
            <div class="bubble-wrap" style="height: 40em; overflow-y: hidden; overflow-x: hidden; padding-right: 100px; margin-right: -100px;">
                <div class="bubble-text-time" style="clear: both; text-align: center; font-size: 0.6em; color: rgba(0,0,0,0.5); margin: 0.5em 0;">
                    <div>iMessage</div>
                        <div>{{{2}}}</div></div>{{{3}}}</div>[[User:Edit Mr./iMessage|<div class="message-input" style="height: 1.7em; border-radius: 0.85em; border: 0.7px solid rgba(0,0,0,0.25); margin: 0.2em 0.3em; color: rgba(0,0,0,0.6); padding: 0 0.5em;">輸入訊息</div>]]
                </div>
            </div>
        </div>
    </div>
</center>

=======
>>>>>>> 4ae3b0bd4d6f3b42de5c5f1438393d198b17f5c0
  </div>
      <div class="msg">
         <p id="message">
         </p>
      </div>
      <script>
         var t1 = window.setInterval(hello,1000); 
         function hello(){ 
                 let requestURL = "https://script.google.com/macros/s/AKfycbyBMmqH6mir6KV1Sklt3jxr4sPVsubVjYjToGZvEfdeuw9KaZgZPtpFCc3I2vCzPLFP/exec";
                 let request = new XMLHttpRequest();
                 request.open("GET", requestURL);
                 request.responseType = "text";
                 request.send();
                 request.onload = function () {
                    $("#message").html(request.response);
                 };
         } 
                 $(function () {
                 // 監聽 按鈕點擊
                 $("#sendOrder").click(function (e) {
                     // 姓名
                     var name = $("#name").val();
                     $("input").focus(function () {
                         $(this).css("border", "");
                     });
                     var msg = $("#msg").val();
                     // 擋住不填資料
                     if (name == "") {
                         $("#name").css("border", "1px solid #ff0000");
                     } else {
                         var data = {
                             name: name,
                             msg: msg
                         };
                         $.ajax({
                             // 這邊用get type
                             type: "post",
                             // api url - google appscript 產出的 url
                             url: "https://script.google.com/macros/s/AKfycbyBMmqH6mir6KV1Sklt3jxr4sPVsubVjYjToGZvEfdeuw9KaZgZPtpFCc3I2vCzPLFP/exec",
                             // 剛剛整理好的資料帶入
                             data: data,
                             // 資料格式是JSON
                             dataType: "JSON",
                             // 成功送出 會回頭觸發下面這塊
                             success: function (response) {
                                 console.log(response);
                                 alert("成功!!");
                             },
                         });
                     }
                 });
             });
      </script>
   </body>
</html>
