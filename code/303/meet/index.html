<html>
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9R5PZG2VQG"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-9R5PZG2VQG');
    </script>
    <meta charset="utf-8">
    <title>303Classroom/Meet連結</title>
    <meta name="description" content="輕鬆進入Classroom, Meet">
    <meta name="keywords" content=", Edit Mr., 週報">
    <meta name="author" content="Elvis Mao">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#00adb5">
    <link href="https://emsbase.blogspot.com/favicon.ico" rel="icon" type="image/x-icon">
    <link href="../../../css/normalize.css" rel="stylesheet" type="text/css">
    <link href="cyberpunk.css" rel="stylesheet" type="text/css">
  </head>
  <body>
    <h1 style="font-size: 30px;">303 Meet連結</h1>
    <h2 style="font-size: 20px;" id="upHeader">資料讀取中...</h2 >
        <button class="cybr-btn" id="thisClass">
      <span id="thisClassTitleG">資料讀取中</span><span aria-hidden>_</span>
      <span aria-hidden class="cybr-btn__glitch" id="thisClassTitle">資料讀取中</span>
      <span aria-hidden class="cybr-btn__tag" id="thisClassCap">課程</span>
    </button>
    <button class="cybr-btn" id="thisMeet">
      <span id="thisMeetTitleG">資料讀取中</span><span aria-hidden>_</span>
      <span aria-hidden class="cybr-btn__glitch" id="thisMeetTitle">資料讀取中</span>
      <span aria-hidden class="cybr-btn__tag" id="thisMeetCap">代碼</span>
    </button>
    <h2 style="font-size: 20px;" id="downHeader">資料讀取中...</h2>
    <button class="cybr-btn" id="nextClass">
      <span id="nextClassTitleG">資料讀取中</span><span aria-hidden>_</span>
      <span aria-hidden class="cybr-btn__glitch" id="nextClassTitle">資料讀取中</span>
      <span aria-hidden class="cybr-btn__tag" id="nextClassCap">課程</span>
    </button>
    <button class="cybr-btn" id="nextMeet">
      <span id="nextMeetTitleG">資料讀取中</span><span aria-hidden>_</span>
      <span aria-hidden class="cybr-btn__glitch" id="NextMeetTitle">資料讀取中</span>
      <span aria-hidden class="cybr-btn__tag" id="nextMeetCap">代碼</span>
    </button>
    <script>
      function setPath(obj) {
      var today = new Date();
      var day = today.getDay()
      var hour = today.getHours();
      var minute = today.getMinutes();
      if(day == "0" || day == "6"){
        var show = [4];
      }else if(hour < "8" || minute < "30"){
        var show = [2, 0];
      }else if(hour < "8" || minute < "50"){
        var show = [0, 0];
      }else if(hour < "9" || minute < "10"){
        var show = [1, 0];
      }else if(hour < "9" || minute < "50"){
        var show= [0, 1];
      }else if(hour < "10" || minute < "10"){
        var show = [1, 1];
      }else if(hour < "10" || minute < "50"){
        var show = [0, 2];
      }else if(hour < "11" || minute < "10"){
        var show = [1, 2];
      }else if(hour < "11" || minute < "50"){
        var show = [0, 3];
      }else if(hour < "13" || minute < "10"){
        var show = [1, 3];
      }else if(hour < "13" || minute < "50"){
        var show = [0, 4];
      }else if(hour < "14" || minute < "10"){
        var show = [1, 4];
      }else if(hour < "14" || minute < "50"){
        var show = [0, 5];
      }else{
        var show = [3, 5];
      }
      const curriculum = obj['curriculum'];
      const code = obj['code'];
      const url = obj['url'];
      let num = obj['number'];

              /*Array:
        0:This This Next Next = #, class, class
        1.Last Last Next Next = #, class, class
        2.Next Next = #, class
        3.Last Last = #, class
        4.No =
        var thisMeet = ""
        var thisClass = ""
        var nextMeet = ""
        var nextClass = ""
        var thisMeetTitle = ""
        var thisClassTitle = ""
        var nextMeetTitle = ""
        var nextClassTitle = ""
        var thisMeetCap = ""
        var thisClassCap = ""
        var nextMeetCap = ""
        var nextClassCap = ""*/
      let index = show[1]
      if(show[0] == 0){
        var now = "" + day + index;
        var tom = index+1;
        var next = "" + day + tom;
        var set = [url[now], code[now], url[next], code[next], '這節Classroom', '這節Meet', '下節Classroom', '下節Meet', num[index], num[tom]];
        document.getElementById("upHeader").innerHTML = "現在在上" + now + "課";
        document.getElementById("upHeader").innerHTML = "下一節是" + next + "課";
      }else if(show[0] == 1){
        var now = "" + day + index;
        var tom = index+1;
        var next = "" + day + tom;
        var set = [url[now], code[now], url[next], code[next], '上節Classroom', '上節Meet', '下節Classroom', '下節Meet', num[index], num[tom]];
        document.getElementById("upHeader").innerHTML = "剛才在上" + now + "課";
        document.getElementById("upHeader").innerHTML = "下一節是" + next + "課";
      }else {
        document.getElementById("thisClass").style.visibility="none";
        document.getElementById("thisMeet").style.visibility="none";
        if(show[0] == 2){
          var next = "" + day + (index+1);
          var set = ['', '', url[next], code[next], '', '', '下節Classroom', '下節Meet', '', num[index]];
      }else if(show[0] == 3){
          var next = "" + day + (index+1);
          var set = ['', '', url[next], code[next], '', '', '剛才Classroom', '剛才Meet', '', num[index]];
      }else{
        document.getElementById("NextMeet").style.visibility="none";
        var set = ['', '', '', '', '', '', 'Classroom', '首頁', '','HOME'];
      }}
      document.getElementById("thisMeet").href = "https://meet.google.com/lookup/" + set[0];
      document.getElementById("thisClass").href = "https://classroom.google.com/u/2/c/" + set[1];
      document.getElementById("nextMeet").href = "https://meet.google.com/lookup/" + set[2];
      document.getElementById("nextClass").href = "https://classroom.google.com/u/2/c/" + set[3];
      document.getElementById("thisMeetTitle").innerHTML = set[4];
      document.getElementById("thisClassTitle").innerHTML = set[5];
      document.getElementById("nextMeetTitle").innerHTML = set[6];
      document.getElementById("nextClassTitle").innerHTML = set[7];
      document.getElementById("thisMeetTitleG").innerHTML = set[4];
      document.getElementById("thisClassTitleG").innerHTML = set[5];
      document.getElementById("nextMeetTitleG").innerHTML = set[6];
      document.getElementById("nextClassTitleG").innerHTML = set[7];
      document.getElementById("thisMeetCap").innerHTML = set[0];
      document.getElementById("thisClassCap").innerHTML = set[8];
      document.getElementById("nextMeetCap").innerHTML = set[9];
      document.getElementById("nextClassCap").innerHTML = set[3];
    }
    let requestURL = 'https://Edit-Mr.github.io/code/303/meet/link.json';
    let request = new XMLHttpRequest();
    request.open('GET', requestURL);
    request.responseType = 'json';
    request.send();
    request.onload = function() {
      const link = request.response;
      setPath(link);
    }
    </script>
  </body>
</html>
