<html>
    <head>
        <!-- Global site tag (gtag.js) - Google Analytics -->

        <script async src="https://www.googletagmanager.com/gtag/js?id=G-9R5PZG2VQG"></script>

        <script>
            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag("js", new Date());

            gtag("config", "G-9R5PZG2VQG");
        </script>

        <meta charset="utf-8" />
        <title>與我聯絡</title>

        <meta name="description" content="歡迎填寫表單來與我聯絡" />

        <meta name="keywords" content="毛哥EM, Edit Mr., 聯絡" />

        <meta name="author" content="Elvis Mao" />

        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <meta name="theme-color" content="#00adb5" />

        <link href="../../Logo.png" rel="icon" type="image/x-icon" />

        <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet" type="text/css" />

        <link rel="stylesheet" type="text/css" href="../../../css/normalize.css" media="screen" />

        <link rel="stylesheet" type="text/css" href="style.css" />

        <script src="https://cdnjs.cloudflare.com/ajax/libs//1.11.1/jquery.min.js"></script>
    </head>

    <body>
        <div class="login-root">
            <div class="box-root flex-flex flex-direction--column" style="min-height: 100vh; flex-grow: 1;">
                <div class="loginbackground box-background--white padding-top--64">
                    <div class="loginbackground-gridContainer">
                        <div class="box-root flex-flex" style="grid-area: top / start / 8 / end;">
                            <div class="box-root" style="background-image: linear-gradient(white 0%, rgb(247, 250, 252) 33%); flex-grow: 1;"></div>
                        </div>

                        <div class="box-root flex-flex" style="grid-area: 4 / 2 / auto / 5;">
                            <div class="box-root box-divider--light-all-2 animationLeftRight tans3s" style="flex-grow: 1;"></div>
                        </div>

                        <div class="box-root flex-flex" style="grid-area: 6 / start / auto / 2;">
                            <div class="box-root box-background--blue800" style="flex-grow: 1;"></div>
                        </div>

                        <div class="box-root flex-flex" style="grid-area: 7 / start / auto / 4;">
                            <div class="box-root box-background--blue animationLeftRight" style="flex-grow: 1;"></div>
                        </div>

                        <div class="box-root flex-flex" style="grid-area: 8 / 4 / auto / 6;">
                            <div class="box-root box-background--gray100 animationLeftRight tans3s" style="flex-grow: 1;"></div>
                        </div>

                        <div class="box-root flex-flex" style="grid-area: 2 / 15 / auto / end;">
                            <div class="box-root box-background--cyan200 animationRightLeft tans4s" style="flex-grow: 1;"></div>
                        </div>

                        <div class="box-root flex-flex" style="grid-area: 3 / 14 / auto / end;">
                            <div class="box-root box-background--blue animationRightLeft" style="flex-grow: 1;"></div>
                        </div>

                        <div class="box-root flex-flex" style="grid-area: 4 / 17 / auto / 20;">
                            <div class="box-root box-background--gray100 animationRightLeft tans4s" style="flex-grow: 1;"></div>
                        </div>

                        <div class="box-root flex-flex" style="grid-area: 5 / 14 / auto / 17;">
                            <div class="box-root box-divider--light-all-2 animationRightLeft tans3s" style="flex-grow: 1;"></div>
                        </div>
                    </div>
                </div>

                <div class="box-root padding-top--24 flex-flex flex-direction--column" style="flex-grow: 1; z-index: 9;">
                    <div class="box-root padding-top--48 padding-bottom--24 flex-flex flex-justifyContent--center">
                        <h1>與毛哥EM聯絡</h1>
                    </div>

                    <div class="formbg-outer">
                        <div class="formbg">
                            <div class="formbg-inner padding-horizontal--48">
                                <span class="padding-bottom--15">歡迎填寫表單來與我聯絡</span>

                                <form id="stripe-login">
                                    <div class="field padding-bottom--24">
                                        <label for="name">姓名</label>

                                        <input type="name" name="name" class="name" />
                                    </div>

                                    <div class="field padding-bottom--24">
                                        <div class="grid--50-50">
                                            <label for="email">EMail</label>
                                        </div>

                                        <input type="email" name="email" class="email" />
                                    </div>

                                    <div class="field field-checkbox padding-bottom--24 flex-flex align-center">
                                        <label for="checkbox"> <input type="checkbox" name="checkbox" class="recieve" /> 願意接受回信 </label>
                                    </div>

                                    <div class="field padding-bottom--24">
                                        <label for="content">內容</label>

                                        <input type="content" name="content" class="content" />
                                    </div>

                                    <div class="field padding-bottom--24">
                                        <button type="button" id="sendOrder">送出</button>
                                    </div>

                                    <div class="field">
                                        <a class="ssolink" href="#">查詢以往表單</a>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <div class="footer-link padding-top--24">
                            <span>本網站由<a href="https://github.com/Edit-Mr">毛哥EM(Edit Mr.)</a>製作，若有任何問題歡迎<a href="mailto:elvismao@ctemplar.com">與我聯絡</a>。也歡迎幫我買杯咖啡 </span>

                            <div class="listing padding-top--24 padding-bottom--24 flex-flex center-center">
                                <a href="mailto:elvismao@ctemplar.com"><img src="https://img.shields.io/badge/-elvismao@ctemplar.com-D14836?style=flat-square&logo=Gmail&logoColor=white" /></a>

                                <a href="https://www.paypal.me/elvismao"><img src="https://img.shields.io/badge/-elvismao.070512@gmail.com-169BD7?style=flat-square&logo=PayPal&logoColor=white" /></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            $(function () {
                // 監聽 送出訂單 按鈕點擊

                // 下面這段主要在組合資料，還有擋使用者不填資料不能送出

                $("#sendOrder").click(function (e) {
                    var status = true;

                    // 姓名

                    var name = $("#name").val();

                    // 電話

                    var phone = $("#email").val();

                    // 主旨

                    var recieve = $("#recieve").val();

                    var content = $("#content").val();

                    // 擋住不填資料邏輯

                    if (name == "") {
                        $("#name").css("border", "1px solid #ff0000");

                        status = false;
                    }

                    if (email == "") {
                        $("#phone").css("border", "1px solid #ff0000");

                        status = false;
                    }

                    if (content == "") {
                        alert("請輸入內容");

                        status = false;
                    }

                    // 如果 �必填欄位都過了 才會到這邊

                    if (status) {
                        // 增加日期資料

                        var currentdate = new Date();

                        var filltime = currentdate.getFullYear() + "/" + (currentdate.getMonth() + 1) + "/" + currentdate.getDate() + "  " + currentdate.getHours() + ":" + currentdate.getMinutes() + ":" + currentdate.getSeconds();

                        // 打包 要的資料

                        var data = {
                            name: name,

                            email: email,

                            time: filltime,

                            rwcieve: recieve,

                            content: content,
                        };

                        // 呼叫 send ajax function

                        send(data);
                    }
                });
            });

            function send(data) {
                $.ajax({
                    // 這邊用get type

                    type: "get",

                    // api url - google appscript 產出的 url

                    url: "https://script.google.com/macros/s/�xxxxxxxxxxxxxxxxxxxxxxxx/exec",

                    // 剛剛整理好的資料帶入

                    data: data,

                    // 資料格式是JSON

                    dataType: "JSON",

                    // 成功送出 會回頭觸發下面這塊感謝

                    success: function (response) {
                        console.log(response);

                        alert("感謝您的訂購！！");
                    },
                });
            }
        </script>
    </body>
</html>
