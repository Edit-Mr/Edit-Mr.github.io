<!DOCTYPE html>
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9R5PZG2VQG"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
            dataLayer.push(arguments);
        }
        gtag("js", new Date());

        gtag("config", "G-9R5PZG2VQG");
    </script>
    <meta charset="utf-8" />
    <title>新增學生 - 大眼蛙教練點名系統</title>
    <meta name="description" content="快速紀錄出缺席" />
    <meta name="keywords" content="大眼蛙教練, Edit Mr., 毛哥EM" />
    <meta name="author" content="Edit Mr." />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="0088FF" />
    <link rel="stylesheet" type="text/css" href="../style.css" media="screen" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NHBZ3RD" height="0" width="0" style="display: none; visibility: hidden;"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <main>
        <h1><a href="../">大眼蛙教練點名系統</a></h1>
        <p>新增學生</p>
        <input type="text" class="form-control" id="name" />
        <button type="button" id="sendOrder">新增</button>
        <p>
            <a href="../../../">毛哥EM</a>製作<br />
            送出後請稍等數秒 勿重複新增
        </p>
    </main>
    <script>
        $(function () {
            // 監聽 按鈕點擊
            $("#sendOrder").click(function (e) {
                // 姓名
                var name = $("#name").val();
                $("input").focus(function () {
                    $(this).css("border", "");
                });
                // 擋住不填資料
                if (name == "") {
                    $("#name").css("border", "1px solid #ff0000");
                } else {
                    var name = name.replace(" ", "");
                    var data = {
                        name: name,
                    };
                    $.ajax({
                        // 這邊用get type
                        type: "get",
                        // api url - google appscript 產出的 url
                        url: "https://script.google.com/macros/s/AKfycbyNU2bnrNC1vecUKgWB4lx1D8CePpjQ2MYcnELUtrWSbbqJ-rQ-JvKbngQhZ3NrjXyR/exec",
                        // 剛剛整理好的資料帶入
                        data: data,
                        // 資料格式是JSON
                        dataType: "JSON",
                        // 成功送出 會回頭觸發下面這塊
                        success: function (response) {
                            console.log(response);
                            alert("新增成功!!");
                        },
                    });
                }
            });
        });
    </script>
</body>
